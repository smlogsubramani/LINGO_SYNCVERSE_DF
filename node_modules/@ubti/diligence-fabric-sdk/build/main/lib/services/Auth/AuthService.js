"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AuthService = void 0;
const config_1 = require("../../../config");
const Request_1 = require("../../../core/Request");
const LoggerService_1 = require("../Logger/LoggerService");
// eslint-disable-next-line functional/no-class
class AuthService {
    constructor(appId, tenantId, appEnvironmentCODE) {
        this.tenantId = tenantId;
        this.appId = appId;
        this.appEnvironmentCODE = appEnvironmentCODE;
    }
    setUserToken(token) {
        this.headers = { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` };
        const decodedData = JSON.parse(atob(token.split('.')[1]));
        this.userId = parseInt(decodedData === null || decodedData === void 0 ? void 0 : decodedData.userId, 0);
        this.tenantId = parseInt(decodedData === null || decodedData === void 0 ? void 0 : decodedData.TenantID, 0);
    }
    async Register(requestBody) {
        LoggerService_1.LoggerService.Logger.info("Register flow " + requestBody);
        return (0, Request_1.request)(config_1.SdkConfig, {
            method: 'POST',
            url: config_1.SdkConfig.ServiceConfig.AuthService.Register,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    ValidateToken(token) {
        LoggerService_1.LoggerService.Logger.info("Validate Token " + token);
        return (0, Request_1.request)(config_1.SdkConfig, {
            method: 'GET',
            url: `${config_1.SdkConfig.ServiceConfig.AuthService.ValidateToken}?token=${encodeURIComponent(token)}`,
            headers: this.headers
        });
    }
    ValidateTenant(requestBody) {
        LoggerService_1.LoggerService.Logger.info("Validate Tenant " + requestBody);
        return (0, Request_1.request)(config_1.SdkConfig, {
            method: 'POST',
            url: config_1.SdkConfig.ServiceConfig.AuthService.ValidateTenant,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    IsDomainExists(requestBody) {
        LoggerService_1.LoggerService.Logger.info("Domain or Registration Exist" + requestBody);
        return (0, Request_1.request)(config_1.SdkConfig, {
            method: 'POST',
            url: config_1.SdkConfig.ServiceConfig.AuthService.IsDomainExist,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    IsRegistered(requestBody) {
        LoggerService_1.LoggerService.Logger.info("Domain or Registration Exist" + requestBody);
        return (0, Request_1.request)(config_1.SdkConfig, {
            method: 'POST',
            url: config_1.SdkConfig.ServiceConfig.AuthService.IsRegistered,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    async login(requestBody) {
        LoggerService_1.LoggerService.Logger.info("Login " + requestBody.username);
        const authRequestBody = Object.assign(Object.assign({}, requestBody), { tenantID: this.tenantId, appID: this.appId, appEnvironmentCODE: this.appEnvironmentCODE });
        const response = await (0, Request_1.request)(config_1.SdkConfig, {
            method: 'POST',
            url: config_1.SdkConfig.ServiceConfig.LoginServiceURL,
            body: authRequestBody,
            mediaType: 'application/json',
        });
        const loginAuthenticationResponse = { Message: response.Message, StatusCode: response.StatusCode, Result: response.Result.find(x => x.TenantID == this.tenantId) };
        return loginAuthenticationResponse;
    }
    forgotPassword(requestBody) {
        LoggerService_1.LoggerService.Logger.info("forgot Password " + requestBody.email);
        return (0, Request_1.request)(config_1.SdkConfig, {
            method: 'POST',
            url: config_1.SdkConfig.ServiceConfig.AuthService.FORGOTPASS,
            body: requestBody,
            mediaType: 'application/json',
        });
    }
    changePassword(requestBody) {
        return (0, Request_1.request)(config_1.SdkConfig, {
            method: 'PUT',
            url: config_1.SdkConfig.ServiceConfig.AuthService.CHANGEPASS,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    logout() {
        // Implement the logout logic here
        // Reset the isLoggedIn property accordingly
        return;
    }
}
exports.AuthService = AuthService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0aFNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL3NlcnZpY2VzL0F1dGgvQXV0aFNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNENBQTRDO0FBRTVDLG1EQUFnRDtBQVNoRCwyREFBd0Q7QUFNeEQsK0NBQStDO0FBQy9DLE1BQWEsV0FBVztJQU1wQixZQUFZLEtBQWEsRUFBRSxRQUFnQixFQUFFLGtCQUEwQjtRQUNuRSxJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQTtRQUN4QixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQTtRQUNsQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsa0JBQWtCLENBQUE7SUFDaEQsQ0FBQztJQUVNLFlBQVksQ0FBQyxLQUFhO1FBQzdCLElBQUksQ0FBQyxPQUFPLEdBQUcsRUFBRSxjQUFjLEVBQUUsa0JBQWtCLEVBQUUsZUFBZSxFQUFFLFVBQVUsS0FBSyxFQUFFLEVBQUUsQ0FBQTtRQUN6RixNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUN6RCxJQUFJLENBQUMsTUFBTSxHQUFHLFFBQVEsQ0FBQyxXQUFXLGFBQVgsV0FBVyx1QkFBWCxXQUFXLENBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBQzlDLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDLFdBQVcsYUFBWCxXQUFXLHVCQUFYLFdBQVcsQ0FBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUE7SUFDdEQsQ0FBQztJQUVNLEtBQUssQ0FBQyxRQUFRLENBQUMsV0FBMkI7UUFDN0MsNkJBQWEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLFdBQVcsQ0FBQyxDQUFBO1FBRXpELE9BQU8sSUFBQSxp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