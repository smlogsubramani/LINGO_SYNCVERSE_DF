import { SdkConfig } from "../../../../config";
import { request } from "../../../../core/Request";
import { LoggerService } from "../../Logger/LoggerService";
// eslint-disable-next-line functional/no-class
export class ApplicationRoleService {
    headers;
    userId;
    tenantId;
    appId;
    appEnvironmentCODE;
    constructor(appId, tenantId, appEnvironmentCODE) {
        this.tenantId = tenantId;
        this.appId = appId;
        this.appEnvironmentCODE = appEnvironmentCODE;
    }
    setUserToken(token) {
        this.headers = { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` };
        const decodedData = JSON.parse(atob(token.split('.')[1]));
        this.userId = parseInt(decodedData?.userId, 0);
        this.tenantId = parseInt(decodedData?.TenantID, 0);
    }
    async getUserAppRole(requestBody, mode = 'ALL') {
        const url = SdkConfig.ServiceConfig.UserAppRoleService.GETALL;
        requestBody.tenantID = this.tenantId;
        requestBody.calledBy = this.userId;
        requestBody.appID = this.appId;
        requestBody.appEnvironmentCODE = this.appEnvironmentCODE;
        const response = await request(SdkConfig, {
            method: 'POST',
            url: url,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
        if (mode !== 'ALL') {
            response.Result = response.Result.filter(x => x.UserID == this.userId);
        }
        return response;
    }
    async getAppRole(requestBody) {
        const url = SdkConfig.ServiceConfig.UserAppRoleService.GETALL;
        requestBody.tenantID = this.tenantId;
        requestBody.calledBy = this.userId;
        requestBody.appID = this.appId;
        const response = await request(SdkConfig, {
            method: 'POST',
            url: url,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
        return response;
    }
    getAppMenuAppRole(requestBody) {
        const url = SdkConfig.ServiceConfig.AppMenuAppRoleService.GET;
        requestBody.tenantID = this.tenantId;
        requestBody.calledBy = this.userId;
        requestBody.appID = this.appId;
        requestBody.appEnvironmentCODE = this.appEnvironmentCODE;
        return request(SdkConfig, {
            method: 'POST',
            url: url,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    get(requestBody) {
        const url = requestBody.AppID ? SdkConfig.ServiceConfig.ApplicationService.GET : SdkConfig.ServiceConfig.ApplicationService.GETALL;
        requestBody.TenantID = this.tenantId;
        requestBody.CalledBy = this.userId;
        return request(SdkConfig, {
            method: 'POST',
            url: url,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    async getAllAccessibleMenus(useNewFormat = false) {
        let finalAppMenuResponse = [], appMenus = [];
        const requestBody = {
            tenantID: this.tenantId,
            calledBy: this.userId,
            appID: this.appId,
            appEnvironmentCODE: this.appEnvironmentCODE
        };
        const userRoleList = await this.getUserAppRole(requestBody);
        LoggerService.Logger.info("User Role List Response " + userRoleList);
        const filteredResults = userRoleList.Result.filter((x) => x.UserID === this.userId);
        try {
            if (filteredResults.length === 0) {
                throw "User doesn't have any Application Roles associated. Please contact Tenant Admin.";
            }
            const userAppRoleData = JSON.parse(filteredResults[0]?.AppRoles).map(res => res.AppRoleID);
            const appMenuAppRoleRequest = {
                tenantID: this.tenantId,
                calledBy: this.userId,
                appID: this.appId,
                appEnvironmentCODE: this.appEnvironmentCODE
            };
            const appmenuAppRoleResponse = await this.getAppMenuAppRole(appMenuAppRoleRequest);
            const appmenuAppRoleList = appmenuAppRoleResponse.Result;
            for (let i = 0; i < appmenuAppRoleList.length; i++) {
                const data = JSON.parse(appmenuAppRoleList[i].AppRoles);
                const appMenuRole = data.map(x => x.AppRoleID);
                if (appMenuRole.filter((x) => userAppRoleData.includes(x)).length !== 0) {
                    finalAppMenuResponse.push(appmenuAppRoleList[i]);
                }
            }
            if (!useNewFormat) {
                appMenus = finalAppMenuResponse.map(x => ({
                    AppMenuID: x.AppMenuID,
                    AppMenuLabel: x.AppMenuLabel,
                    ParenAppMenuID: x.ParentAppMenuID,
                    AppMenuActionURL: x.AppMenuActionURL,
                    childMenus: []
                }));
                const childMenus = appMenus.filter(res => res.ParenAppMenuID != 0).map(x => ({
                    AppMenuID: x.AppMenuID,
                    AppMenuLabel: x.AppMenuLabel,
                    ParentAppMenuID: x.ParenAppMenuID,
                    AppMenuActionURL: x.AppMenuActionURL,
                    child_Menus: []
                }));
                const child_Menus = childMenus.filter(res => res.ParentAppMenuID != 0).map(x => ({
                    AppMenuID: x.AppMenuID,
                    AppMenuLabel: x.AppMenuLabel,
                    ParentAppMenuID: x.ParentAppMenuID,
                    AppMenuActionURL: x.AppMenuActionURL
                }));
                for (let k = 0; k < appMenus.length; k++) {
                    const tempData = childMenus.filter(x => x.ParentAppMenuID == appMenus[k].AppMenuID);
                    appMenus[k].childMenus = tempData;
                    for (let j = 0; j < appMenus[k].childMenus.length; j++) {
                        const tempData1 = child_Menus.filter(x => x.ParentAppMenuID == appMenus[k].childMenus[j].AppMenuID);
                        appMenus[k].childMenus[j].child_Menus = tempData1;
                    }
                }
            }
            else {
                // New structured format (hierarchical)
                const formattedMenus = finalAppMenuResponse.map(x => ({
                    AppMenuID: x.AppMenuID,
                    AppMenuLabel: x.AppMenuLabel,
                    ParentAppMenuID: x.ParentAppMenuID,
                    AppMenuActionURL: x.AppMenuActionURL,
                    childMenus: []
                }));
                const menuMap = new Map();
                formattedMenus.forEach(menu => menuMap.set(menu.AppMenuID, menu));
                formattedMenus.forEach(menu => {
                    if (menu.ParentAppMenuID && menuMap.has(menu.ParentAppMenuID)) {
                        const parent = menuMap.get(menu.ParentAppMenuID);
                        parent.childMenus.push(menu);
                    }
                });
                appMenus = formattedMenus.filter(menu => !menu.ParentAppMenuID);
            }
            return appMenus;
        }
        catch (error) {
            LoggerService.Logger.error(error);
            return error;
        }
    }
    async isMenuAuthorized(appMenuURLPath) {
        const appRequestBody = {
            TenantID: this.tenantId,
            AppID: this.appId
        };
        const checkApp = await this.get(appRequestBody);
        const menuResult = await this.getAllAccessibleMenus();
        if (Array.isArray(menuResult)) {
            if (menuResult.length === 0) {
                return { status: 404, isAuthorized: false, empty: true, message: "No Menus were found! Please contact your Tenant Admin." };
            }
            if (Boolean(menuResult.find(x => x.AppMenuActionURL && new URL(x.AppMenuActionURL).pathname === appMenuURLPath || appMenuURLPath === '/'))) {
                return { status: 200, isAuthorized: true, empty: false, message: "Authorized" };
            }
        }
        else {
            return { status: 404, isAuthorized: false, empty: true, message: "No Menus were found! Please contact your Tenant Admin." };
        }
        return { status: 403, isAuthorized: false, empty: false, message: "Forbidden! You are not allowed to access this page." };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXBwUm9sZVNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvbGliL3NlcnZpY2VzL0FwcGxpY2F0aW9uL0FwcFJvbGUvQXBwUm9sZVNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLG9CQUFvQixDQUFBO0FBRTlDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQTtBQUNsRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFTM0QsK0NBQStDO0FBQy9DLE1BQU0sT0FBTyxzQkFBc0I7SUFDdkIsT0FBTyxDQUFLO0lBQ1osTUFBTSxDQUFRO0lBQ2QsUUFBUSxDQUFRO0lBQ2hCLEtBQUssQ0FBUztJQUNkLGtCQUFrQixDQUFRO0lBRWxDLFlBQVksS0FBYSxFQUFFLFFBQWdCLEVBQUUsa0JBQTBCO1FBQ25FLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBQ3hCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFBO1FBQ2xCLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQTtJQUNoRCxDQUFDO0lBRU0sWUFBWSxDQUFDLEtBQWE7UUFDN0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLGNBQWMsRUFBRSxrQkFBa0IsRUFBRSxlQUFlLEVBQUUsVUFBVSxLQUFLLEVBQUUsRUFBRSxDQUFBO1FBQ3pGLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBQ3pELElBQUksQ0FBQyxNQUFNLEdBQUcsUUFBUSxDQUFDLFdBQVcsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUE7UUFDOUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUMsV0FB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