import { SdkConfig } from "../../../config";
import { request } from "../../../core/Request";
import { LoggerService } from "../Logger/LoggerService";
// eslint-disable-next-line functional/no-class
export class AuthService {
    tenantId;
    appId;
    appEnvironmentCODE;
    headers;
    userId;
    constructor(appId, tenantId, appEnvironmentCODE) {
        this.tenantId = tenantId;
        this.appId = appId;
        this.appEnvironmentCODE = appEnvironmentCODE;
    }
    setUserToken(token) {
        this.headers = { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` };
        const decodedData = JSON.parse(atob(token.split('.')[1]));
        this.userId = parseInt(decodedData?.userId, 0);
        this.tenantId = parseInt(decodedData?.TenantID, 0);
    }
    async Register(requestBody) {
        LoggerService.Logger.info("Register flow " + requestBody);
        return request(SdkConfig, {
            method: 'POST',
            url: SdkConfig.ServiceConfig.AuthService.Register,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    ValidateToken(token) {
        LoggerService.Logger.info("Validate Token " + token);
        return request(SdkConfig, {
            method: 'GET',
            url: `${SdkConfig.ServiceConfig.AuthService.ValidateToken}?token=${encodeURIComponent(token)}`,
            headers: this.headers
        });
    }
    ValidateTenant(requestBody) {
        LoggerService.Logger.info("Validate Tenant " + requestBody);
        return request(SdkConfig, {
            method: 'POST',
            url: SdkConfig.ServiceConfig.AuthService.ValidateTenant,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    IsDomainExists(requestBody) {
        LoggerService.Logger.info("Domain or Registration Exist" + requestBody);
        return request(SdkConfig, {
            method: 'POST',
            url: SdkConfig.ServiceConfig.AuthService.IsDomainExist,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    IsRegistered(requestBody) {
        LoggerService.Logger.info("Domain or Registration Exist" + requestBody);
        return request(SdkConfig, {
            method: 'POST',
            url: SdkConfig.ServiceConfig.AuthService.IsRegistered,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    async login(requestBody) {
        LoggerService.Logger.info("Login " + requestBody.username);
        const authRequestBody = { ...requestBody, tenantID: this.tenantId, appID: this.appId, appEnvironmentCODE: this.appEnvironmentCODE };
        const response = await request(SdkConfig, {
            method: 'POST',
            url: SdkConfig.ServiceConfig.LoginServiceURL,
            body: authRequestBody,
            mediaType: 'application/json',
        });
        const loginAuthenticationResponse = { Message: response.Message, StatusCode: response.StatusCode, Result: response.Result.find(x => x.TenantID == this.tenantId) };
        return loginAuthenticationResponse;
    }
    forgotPassword(requestBody) {
        LoggerService.Logger.info("forgot Password " + requestBody.email);
        return request(SdkConfig, {
            method: 'POST',
            url: SdkConfig.ServiceConfig.AuthService.FORGOTPASS,
            body: requestBody,
            mediaType: 'application/json',
        });
    }
    changePassword(requestBody) {
        return request(SdkConfig, {
            method: 'PUT',
            url: SdkConfig.ServiceConfig.AuthService.CHANGEPASS,
            body: requestBody,
            mediaType: 'application/json',
            headers: this.headers
        });
    }
    logout() {
        // Implement the logout logic here
        // Reset the isLoggedIn property accordingly
        return;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0aFNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL3NlcnZpY2VzL0F1dGgvQXV0aFNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRTVDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQVNoRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFNeEQsK0NBQStDO0FBQy9DLE1BQU0sT0FBTyxXQUFXO0lBQ1osUUFBUSxDQUFRO0lBQ2hCLEtBQUssQ0FBUztJQUNkLGtCQUFrQixDQUFRO0lBQzFCLE9BQU8sQ0FBSztJQUNaLE1BQU0sQ0FBUTtJQUN0QixZQUFZLEtBQWEsRUFBRSxRQUFnQixFQUFFLGtCQUEwQjtRQUNuRSxJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQTtRQUN4QixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQTtRQUNsQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsa0JBQWtCLENBQUE7SUFDaEQsQ0FBQztJQUVNLFlBQVksQ0FBQyxLQUFhO1FBQzdCLElBQUksQ0FBQyxPQUFPLEdBQUcsRUFBRSxjQUFjLEVBQUUsa0JBQWtCLEVBQUUsZUFBZSxFQUFFLFVBQVUsS0FBSyxFQUFFLEVBQUUsQ0FBQTtRQUN6RixNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUN6RCxJQUFJLENBQUMsTUFBTSxHQUFHLFFBQVEsQ0FBQyxXQUFXLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBQzlDLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDLFdBQVcsRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFD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